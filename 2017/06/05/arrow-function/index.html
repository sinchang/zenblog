<html>

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1,shrink-to-fit=no,user-scalable=no">
    <title>sinchang</title>
    <link rel="icon" href="/favicon.ico">
    <!-- Custom styles for this template -->
    <link rel="stylesheet" href="/css/blog.css">
    <link href="http://cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Google Analytics -->
    

</head>


<body>
    <div class="mask"></div>
    <div class="container">
        <div class="main">
    <div class="blog-post">
        <a href="/" title="回到首页"><i class="fa fa-home back-home" aria-hidden="true"></i></a>
        <!-- Title -->
        <h2 class="blog-post-title">
            <a href="/2017/06/05/arrow-function/">
                什么情况下不能使用箭头函数
            </a>
        </h2>

        <!-- Date and Author -->
        <p class="blog-post-meta">
            2017-06-05
            
        </p>

        <!-- Content -->
        <div class="post-content">
            <p>学过 ES6 的想必对于箭头函数都非常熟悉，它没有自己的 this 值，箭头函数里面的 this 值继承自外围作用域。但是有些特殊情况下是不宜使用箭头函数的，下面就列举下。</p>
<h3 id="点击事件"><a href="#点击事件" class="headerlink" title="点击事件"></a>点击事件</h3><p>假设页面上有个按钮，当点击时改变它的 class。</p>
<p>使用箭头函数写法如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">'btn'</span>).addEventListener(<span class="string">'click'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="keyword">this</span>.classList.toggle(<span class="string">'on'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>这样的话，箭头函数里面的 this 是指向 Window，这就不符合预期。</p>
<p>正确写法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">'btn'</span>).addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.classList.toggle(<span class="string">'on'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="对象方法"><a href="#对象方法" class="headerlink" title="对象方法"></a>对象方法</h3><p>假设这里有个 person 对象，有个 getName 方法来输出它的 name。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> person = &#123;</span><br><span class="line">  name: <span class="string">'sinchang'</span>,</span><br><span class="line">  getName: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>同样的，这是箭头函数里面的 this 也是指向 Window。</p>
<p>正确写法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> person = &#123;</span><br><span class="line">  name: <span class="string">'sinchang'</span>,</span><br><span class="line">  getName: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="prototype-方法"><a href="#prototype-方法" class="headerlink" title="prototype 方法"></a>prototype 方法</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">    <span class="keyword">this</span>.age = age</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person.ptototype.getName = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person(<span class="string">'sinchang'</span>, <span class="string">'18'</span>)</span><br></pre></td></tr></table></figure>
<p>此时箭头函数里面的 this 指向 Window。</p>
<p>正确写法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">    <span class="keyword">this</span>.age = age</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person.prototype.getName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Person(<span class="string">'sinchang'</span>, <span class="string">'18'</span>).getName()</span><br></pre></td></tr></table></figure>
<h3 id="获取-arguments-对象的时候"><a href="#获取-arguments-对象的时候" class="headerlink" title="获取 arguments 对象的时候"></a>获取 arguments 对象的时候</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getArg = <span class="function">(<span class="params">name, age</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">arguments</span>.length)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>因为在箭头函数中是没有 arguments 对象的，所以上述代码无法运行。</p>
<p>正确写法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getArg = <span class="function"><span class="keyword">function</span> (<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">arguments</span>.length)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">getArg(<span class="string">'sinchang'</span>, <span class="string">'18'</span>)</span><br></pre></td></tr></table></figure>
<p>参考资料：</p>
<ul>
<li><a href="http://wesbos.com/arrow-function-no-no/" target="_blank" rel="noopener">When Not to use an Arrow Function</a></li>
</ul>

        </div>

        <!-- Tags and Categories links -->
        

<div class="blog-tags-container">
    <a href="/tags/ES6/"><i class="fa fa-tag"></i>ES6</a>
</div>


        

<div class="blog-categories-container">
    <a href="/categories/JavaScript/"><i class="fa fa-file"></i>JavaScript</a>
</div>


    </div>
</div>


    </div>

    <!-- Footer -->
    <footer class="blog-footer">
    <p>&copy; 2018 sinchang</p>
    <p>Proudly published with <a href="http://hexo.io/">Hexo</a> | theme - <a href="https://github.com/sinchang/hexo-theme-zenblog">Zenblog</a></p>
</footer>


    <!-- After footer scripts -->
    <script type="text/javascript" src="http://sinchang.qiniudn.com/link-icon.min.js"></script>
<script src="/js/main.js"></script>

</body>

</html>
